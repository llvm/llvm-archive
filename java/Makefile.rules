##==-- Makefile.rules - Common make rules for Java -------*- makefile -*--====##
#
#                     The LLVM Compiler Infrastructure
#
# This file was developed by the LLVM research group and is distributed under
# the University of Illinois Open Source License. See LICENSE.TXT for details.
#
##===----------------------------------------------------------------------===##

ifdef BUILD_JAVA_SOURCE
all:: .class-stamp
.class-stamp: $(shell find . -name '*.java')
	$(JAVAC) $?
	touch .class-stamp
endif

CLASS2LLVM := $(PROJTOOLCURRENT)/class2llvm$(EXEEXT)
LDIS  := $(LLVMTOOLCURRENT)/llvm-dis$(EXEEXT)
LAS   := $(LLVMTOOLCURRENT)/llvm-as$(EXEEXT)
LLINK := $(LLVMTOOLCURRENT)/llvm-link$(EXEEXT)
LOPT  := $(LLVMTOOLCURRENT)/opt$(EXEEXT)

# rule to make assembly from bytecode
%.dis-ll: %.bc
	$(LDIS) < $< > $@

# rule to make bytecode from assembly
%.bc: %.ll
	$(LAS) < $< > $@
